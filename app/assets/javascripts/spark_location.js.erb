$(document).ready(function() {

  var ask_for_geolocation = function() {

    function handleNoGeolocation(errorFlag) {
      if (errorFlag) {
        console.log("Geolocation service failed.");
      } else {
        console.log("Your browser doesn't support geolocation.");
      }
    };

    var send_data = function() {
      $("#lat").val(latitude)
      $("#lon").val(longitude)

    }
    if(navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        latitude = position.coords.latitude;
        longitude = position.coords.longitude;
        send_data()
      },

      function() {
        handleNoGeolocation(true);
      });
    }
    // If browser doesn't support Geolocation
    else {
      handleNoGeolocation(false);
    }
  }

  if ($('#new_spark').length != 0){
    ask_for_geolocation();
  }

});






